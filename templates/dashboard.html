{% extends 'base.html' %}

{% block title %}Dashboard - Payroll System{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block content %}

<div class="stats-cards">
<div class="stat-card">
<div class="stat-card-icon text-blue">
<i class="bi bi-people-fill"></i>
</div>
<div class="stat-card-info">
<h3>Total Employees</h3>
<span>{{ total_employees }}</span>
</div>
</div>

<div class="stat-card">
    <div class="stat-card-icon text-red">
        <i class="bi bi-cash"></i>
    </div>
    <div class="stat-card-info">
        <h3>Total Salary</h3>
        <span>₱{{ total_salary }}</span>
    </div>
</div>

<div class="stat-card">
    <div class="stat-card-icon text-lblue">
        <i class="bi bi-graph-up"></i>
    </div>
    <div class="stat-card-info">
        <h3>Average Salary</h3>
        <span>₱{% if total_employees > 0 %}{{ "%.2f"|format(total_salary|float / total_employees) }}{% else %}0.00{% endif %}</span>
    </div>
</div>

<div class="stat-card">
    <div class="stat-card-icon text-grey">
        <i class="bi bi-receipt"></i>
    </div>
    <div class="stat-card-info">
        <h3>Recent Payments</h3>
        <span>0</span> {# Placeholder as per image #}
    </div>
</div>


</div>

<div class="dashboard-columns">

<div class="card">
    <div class="card-header">
        <h3>Quick Actions</h3>
    </div>
    <div class="action-buttons">
        <a href="{{ url_for('add_employee_route') }}" class="btn-quick-action btn-blue">
            <i class="bi bi-person-plus-fill"></i>
            <span>Add Employee</span>
        </a>
        <form action="{{ url_for('process_payroll') }}" method="POST" onsubmit="return confirm('This will process payroll for all employees for the current month. Are you sure?');" style="margin: 0;">
            <button type="submit" class="btn-quick-action btn-red" style="width: 100%;">
                <i class="bi bi-calculator-fill"></i>
                <span>Process Payroll</span>
            </button>
        </form>
        <a href="{{ url_for('employee_list') }}" class="btn-quick-action btn-blue">
            <i class="bi bi-file-earmark-text-fill"></i>
            <span>View Reports</span>
        </a>
        <a href="#" class="btn-quick-action btn-red">
            <i class="bi bi-people-fill"></i>
            <span>Manage Staff</span>
        </a>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3>Recent Employees</h3>
    </div>
    <ul class="employee-list">
        {% for employee in employees[0:5] %} <li class="employee-list-item">
            <div class="employee-info">
                <img src="{{ url_for('static', filename='uploads/' + (employee.photo if employee.photo else 'default.png')) }}" 
                     alt="{{ employee.name }}"
                     onerror="this.src='{{ url_for('static', filename='uploads/default.png') }}';">
                <span>{{ employee.name }}</span>
            </div>
            <span class="employee-position">{{ employee.position }}</span>
        </li>
        {% else %}
        <li class="employee-list-item">
            <span>No employees found.</span>
        </li>
        {% endfor %}
    </ul>
</div>


</div>
{% endblock %}

{% block scripts %}

{% endblock %}