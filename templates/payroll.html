{% extends 'base.html' %}

{% block title %}View Payroll - Payroll System{% endblock %}
{% block page_title %}Employee Payslip{% endblock %}

{% block content %}

<div class="card payslip-card">
<div class="payslip-header">
<div class="payslip-header-info">
<img src="{{ url_for('static', filename='uploads/' + (employee.photo if employee.photo else 'default.png')) }}"
alt="{{ employee.name }}"
class="payslip-photo"
onerror="this.src='{{ url_for('static', filename='uploads/default.png') }}';">
<div>
<h2>{{ employee.name }}</h2>
<p>{{ employee.position }}</p>
<p>{{ employee.department }}</p>
</div>
</div>
<div class="payslip-header-actions">
<a href="{{ url_for('download_payroll_pdf', emp_id=employee.id) }}" class="btn btn-action btn-blue">
<i class="bi bi-download me-1"></i> Download PDF
</a>
</div>
</div>

<div class="payslip-details-grid">
    <div class="payslip-group">
    <h3>Earnings</h3>
    <div class="payslip-item">
        <span>Regular Pay ({{ "%.2f"|format(employee.total_regular_hours) }} hrs)</span>
        <span class="amount positive">₱{{ "%.2f"|format(employee.regular_pay) }}</span>
    </div>
    <div class="payslip-item">
        <span>Overtime Pay ({{ "%.2f"|format(employee.total_overtime_hours) }} hrs)</span>
        <span class="amount positive">₱{{ "%.2f"|format(employee.overtime_pay) }}</span>
    </div>
    </div>
    <div class="payslip-group">
        <h3>Deductions</h3>
        <div class="payslip-item">
            <span>SSS Contribution</span>
            <span class="amount negative">(₱{{ "%.2f"|format(employee.sss) }})</span>
        </div>
        <div class="payslip-item">
            <span>PhilHealth Contribution</span>
            <span class="amount negative">(₱{{ "%.2f"|format(employee.philhealth) }})</span>
        </div>
        <div class="payslip-item">
            <span>Pag-IBIG Contribution</span>
            <span class="amount negative">(₱{{ "%.2f"|format(employee.pagibig) }})</span>
        </div>
        <div class="payslip-item">
            <span>Withholding Tax (EWT)</span>
            <span class="amount negative">(₱{{ "%.2f"|format(employee.tax) }})</span>
        </div>
        <div class="payslip-item">
            <span>Loan Deductions</span>
            <span class="amount negative">(₱{{ "%.2f"|format(employee.loan_deductions) }})</span>
        </div>
    </div>
</div>

<div class="payslip-summary">
    <div class="summary-item">
        <span>Gross Earnings</span>
        <strong>₱{{ "%.2f"|format(employee.salary) }}</strong>
    </div>
    <div class="summary-item">
        <span>Total Deductions</span>
        <strong>₱{{ "%.2f"|format(employee.total_deductions) }}</strong>
    </div>
    <div class="summary-item total">
        <span>Net Pay</span>
        <strong class="net-pay-total">₱{{ "%.2f"|format(employee.net_salary) }}</strong>
    </div>
</div>

<div class="payslip-footer">
    <p><strong>Payroll Period:</strong> {{ employee.pay_period_start }} to {{ employee.pay_period_end }}</p>
    <p><strong>Pay Date:</strong> {{ employee.pay_period_end }}</p>
</div>


</div>
{% endblock %}